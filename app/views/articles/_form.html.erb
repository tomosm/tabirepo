<%= stylesheet_link_tag "articles", :media => "all" %>
<%= form_for @article, :html => {:class => 'form-horizontal'} do |f| %>

<% if @article.errors.any? %>
  <div class="control-group">
    <div class="controls alert alert-block">
      <button type="button" class="close" data-dismiss="alert">&times;</button>
  <% @article.errors.full_messages.each do |msg| %>
      <p><%= msg %></p>
  <% end -%>
    </div>
  </div>
<% end -%>

<div class="control-group">
  <%= f.label :title, 'レポート名', :class => 'control-label'%>
  <div class="controls">
    <div class="input-prepend">
      <!-- <span class="add-on"><i class="icon-pencil"></i></span> -->
      <%= f.text_field :title, :placeholder => 'レポート名', :required => "required", :class => "span7" %>  
    </div>
  </div>
</div>


<div class="control-group">
  <%= f.label '投稿写真', :class => 'control-label'%>
  <div class="controls">
    <div>
      <%#= f.file_field :photo, :required => "required" --%>
      <div id="fine-uploader"></div>
      <div id="file-image" class="image-container photo">
        <% if @url %>
          <%=  image_tag(@url, :class => "article-photo") %>  
        <% else %>
          <img class="article-photo" src="" alt="NO IMAGE">
        <% end -%>
        <%= f.hidden_field :image_id -%> 
        <%#= f.fields_for :image do |fimage| --%>
          <%#= fimage.hidden_field :id --%>  
        <%# end --%>
      </div>
    </div>
  </div>
</div>

<div class="control-group">
  <%= f.label '旅のシチュエーション', :class => 'control-label'%>
  <div class="controls">
    <%= f.select :theme_id, @themes, :prompt => '記事のテーマ？', :required => "required" %></div><div class="controls">
    <%= f.select :country_id, @countries, :prompt => '国？', :required => "required" %></div><div class="controls">
    <%= f.select :vihicle_id, @vihicles, :prompt => '移動手段？', :required => "required" %></div><div class="controls">
    <%= f.select :member_id, @members, :prompt => '人数？', :required => "required" %></div><div class="controls">
    <%= f.select :purpose_id, @purposes, :prompt => '目的？', :required => "required" %></div><div class="controls">
    <%= f.select :budget_id, @budgets, :prompt => '予算？', :required => "required" %></div><div class="controls">
    <%= f.select :language_id, @languages, :prompt => '言語力？', :required => "required" %></div><div class="controls">
    <%= f.select :age_id, @ages, :prompt => '年齢？', :required => "required" %>
  </div>
</div>

<div class="control-group">
    <div class="controls">
      <label class="checkbox" for="article_entry_program">
        <%= f.check_box :entry_program, :class => 'checkbox' %> 特集記事
      </label>
    </div>
</div>

<div class="control-group">
  <%= f.label :outline, '概要', :class => 'control-label'%>
  <div class="controls">
    <%= f.text_area :outline, :placeholder => '概要', :rows => 6, :class => "span7", :required => "required" %>  
  </div>
</div>

<div id="paragraphs-block">
<% @paragraphs.each_with_index do |paragraph, i| -%>
<div class="paragraph">
  <%= f.fields_for :paragraphs, paragraph, :index => paragraph.id do |fp| %>
    <div class="control-group">
      <%= fp.label :subtitle, :class => 'control-label' do %>
      <input type="button" class="remove-paragraph" value="-"/>
        見出し<%= i + 1 %>
      <% end -%>
      <div class="controls">
        <%= fp.text_field :subtitle, :placeholder => '見出し' + (i + 1).to_s, :class => "span7" %>  
      </div>
    </div>
    <div class="control-group">
      <%= fp.label :sentence, :class => 'control-label' do %>
        文章<%= i + 1 %>
      <% end -%>
      <div class="controls">
        <%= fp.text_area :sentence, :placeholder => '文章' + (i + 1).to_s, :rows => 10, :class => "span7" %>  
      </div>
    </div>
    <% if paragraph.persisted? %>
      <%= fp.hidden_field :id, value: paragraph.id %>
    <% end %>
    <%= fp.hidden_field :deleted_at %>
  <% end -%>
</div>
<% end -%>
</div>

<div class="control-group">
  <div class="controls">
    <input type="button" id="add-paragraph" value="+"/>
  </div>
</div>

<div class="control-group">
  <div class="controls">
    <!-- todo 一時保存？ -->
    <!-- todo 確認画面？ -->
  <% if f.object.new_record? %>
    <%= f.submit '投稿', :class => 'btn btn-inverse' %>
  <% else %>
    <%= f.submit :class => 'btn btn-inverse' %>
    <%= link_to 'キャンセル', article_path(@article), :class => 'btn' %>
    <!-- <%= link_to :cancel, article_path(@article), :class => 'btn' %> -->
  <% end %>
  </div>
</div>

<%= f.hidden_field :user_id, :value => current_user.id %>

<% end -%>
